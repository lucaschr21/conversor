<p-card>
  <ng-template pTemplate="header">
    <div class="p-4">
      <h2 class="text-lg font-semibold text-surface-900 dark:text-surface-100">
        Conversão de Moedas
      </h2>
    </div>
  </ng-template>

  <div class="space-y-4">
    <div
      class="bg-surface-50 dark:bg-surface-900 rounded-xl p-4 border border-surface-200 dark:border-surface-700"
    >
      <label for="amount-input" class="block text-sm text-surface-600 dark:text-surface-400 mb-2">
        Você envia
      </label>
      <div class="flex items-center gap-3">
        <p-inputNumber
          inputId="amount-input"
          [(ngModel)]="amount"
          (ngModelChange)="amount.set($event)"
          mode="decimal"
          [minFractionDigits]="2"
          [maxFractionDigits]="2"
          class="flex-1"
          [showButtons]="false"
          inputStyleClass="text-2xl text-surface-900 dark:text-surface-100 bg-transparent w-full outline-none border-none shadow-none p-0"
        />

        <div
          class="flex items-center gap-2 px-4 py-2 bg-white dark:bg-surface-800 rounded-lg border border-surface-200 dark:border-surface-700"
        >
          @if (baseCurrencyData(); as base) {
          <span [class]="'fi fi-' + base.code.substring(0, 2).toLowerCase()"></span>
          <span>{{ base.code }}</span>
          }
        </div>
      </div>
    </div>

    <div
      class="bg-surface-50 dark:bg-surface-900 rounded-xl p-4 border border-surface-200 dark:border-surface-700"
    >
      <label
        for="target-currency"
        class="block text-sm text-surface-600 dark:text-surface-400 mb-2"
      >
        Você recebe
      </label>
      <div class="flex items-center gap-3">
        <div class="flex-1 text-2xl text-surface-900 dark:text-surface-100">
          {{ convertedAmount() | number : '1.2-2' }}
        </div>

        <p-select
          inputId="target-currency"
          [options]="currencies()"
          [(ngModel)]="targetCurrencyCode"
          (ngModelChange)="targetCurrencyCode.set($event)"
          optionLabel="code"
          optionValue="code"
          [filter]="true"
          filterBy="code,name"
          placeholder="Selecione"
          styleClass="w-32"
        >
          <ng-template let-currency pTemplate="item">
            <div class="flex items-center gap-2">
              <span [class]="'fi fi-' + currency.code.substring(0, 2).toLowerCase()"></span>
              <span>{{ currency.code }}</span>
            </div>
          </ng-template>
          <ng-template let-currency pTemplate="selectedItem">
            <div class="flex items-center gap-2">
              <span [class]="'fi fi-' + currency.code.substring(0, 2).toLowerCase()"></span>
              <span>{{ currency.code }}</span>
            </div>
          </ng-template>
        </p-select>
      </div>
    </div>

    <div class="text-center pt-2">
      <p class="text-sm text-surface-600 dark:text-surface-400">
        1 {{ baseCurrency() }} = {{ exchangeRate() | number : '1.4-4' }} {{ targetCurrencyCode() }}
      </p>
    </div>
  </div>
</p-card>
